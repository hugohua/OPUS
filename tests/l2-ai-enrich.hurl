# ============================================
# L2: AI Enrich è¯æ±‡å¢å¼ºæµ‹è¯•
# ============================================
# ç«¯ç‚¹: POST /api/ai/enrich
# åŠŸèƒ½: æ‰¹é‡å¢å¼ºè¯æ±‡æ•°æ® (å®šä¹‰ã€ä¾‹å¥ã€æ­é…ç­‰)
# ç”¨é€”: ETL Pipeline / Admin å·¥å…·
#
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# ğŸ“‹ è§„æ ¼å®šä¹‰ (Specification)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# Input (JSON Body):
#   {
#     "inputs": [
#       {
#         "word": string,           // ç›®æ ‡å•è¯
#         "def_en": string          // è‹±æ–‡å®šä¹‰ (å¿…éœ€)
#       }
#     ]
#   }
#
# Output (JSON Schema):
#   {
#     "status": "success" | "error",
#     "data": [
#       {
#         "word": string,
#         "definition_cn": string,
#         "commonExample": string,
#         "collocations": [...]
#       }
#     ]
#   }
#
# Error Response:
#   400: { "status": "error", "message": "..." }
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# ============================================
# Test 1: åŸºç¡€å¢å¼ºè¯·æ±‚ (Happy Path)
# ============================================
POST {{BASE_URL}}/api/ai/enrich
Content-Type: application/json
{
    "inputs": [
        {
            "word": "TEST_strategy",
            "def_en": "a plan of action designed to achieve a long-term goal"
        }
    ]
}

HTTP 200
[Captures]
enriched_data: jsonpath "$.data"
[Asserts]
# 1. Schema éªŒè¯
jsonpath "$.status" isString
jsonpath "$.data" isCollection

# 2. ä¸šåŠ¡é€»è¾‘éªŒè¯
jsonpath "$.status" == "success"

# ============================================
# Test 2: ç¼ºå°‘ inputs å­—æ®µåº”è¿”å› 400
# ============================================
POST {{BASE_URL}}/api/ai/enrich
Content-Type: application/json
{
    "invalid": "data"
}

HTTP 400
[Asserts]
jsonpath "$.status" == "error"

# ============================================
# Test 3: ç¼ºå°‘ def_en åº”è¿”å› 400
# ============================================
POST {{BASE_URL}}/api/ai/enrich
Content-Type: application/json
{
    "inputs": [
        {
            "word": "TEST_strategy"
        }
    ]
}

HTTP 400
[Asserts]
jsonpath "$.status" == "error"
