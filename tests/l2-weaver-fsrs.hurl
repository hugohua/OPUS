# ============================================
# L2: Weaver Lab FSRS é›†æˆæµ‹è¯•
# ============================================
# ç«¯ç‚¹: POST /api/weaver/v2/generate
# åŠŸèƒ½: åŸºäº FSRS é˜Ÿåˆ—ç”Ÿæˆæ²‰æµ¸å¼å•†åŠ¡é˜…è¯»ææ–™ (SSE æµå¼)
# å®‰å…¨: éœ€è¦è®¤è¯ (session cookie)
#
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# ğŸ“‹ è§„æ ¼å®šä¹‰ (Specification)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# Input (JSON Body):
#   {
#     "scenario": string,           // å¿…å¡«: "finance" | "hr" | "marketing" | "rnd"
#     "target_word_ids": number[]?  // å¯é€‰: æ‰‹åŠ¨æŒ‡å®šç›®æ ‡è¯ IDï¼Œä¸ä¼ åˆ™ OMPS è‡ªåŠ¨è£…å¡«
#   }
#
# Output (SSE Stream):
#   Content-Type: text/event-stream
#   
#   data: {"type": "content", "data": "The board has decided..."}
#   data: {"type": "content", "data": " to adopt a new strategy..."}
#   data: {"type": "done"}
#
# Error Response:
#   401: Unauthorized (æ— è®¤è¯)
#   400: { "error": "Invalid scenario" }
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# ============================================
# Test 1: æ— è®¤è¯è®¿é—®åº”è¿”å› 401
# ============================================
POST {{BASE_URL}}/api/weaver/v2/generate
Content-Type: application/json
{
    "scenario": "finance"
}

HTTP 401

# ============================================
# Test 2: è‡ªåŠ¨è£…å¡«æ¨¡å¼ (OMPS é€‰è¯)
# ============================================
# æ³¨æ„: æ­¤æµ‹è¯•éœ€è¦æ‰‹åŠ¨é…ç½® session cookie
#       å–æ¶ˆæ³¨é‡Šå¹¶å¡«å…¥æœ‰æ•ˆ token åè¿è¡Œ
#
# POST {{BASE_URL}}/api/weaver/v2/generate
# Content-Type: application/json
# Cookie: next-auth.session-token={{SESSION_TOKEN}}
# {
#     "scenario": "finance"
# }
# 
# HTTP 200
# [Asserts]
# header "Content-Type" contains "text/event-stream"

# ============================================
# Test 3: æ‰‹åŠ¨æŒ‡å®šç›®æ ‡è¯
# ============================================
# POST {{BASE_URL}}/api/weaver/v2/generate
# Content-Type: application/json
# Cookie: next-auth.session-token={{SESSION_TOKEN}}
# {
#     "scenario": "hr",
#     "target_word_ids": [101, 102, 103]
# }
# 
# HTTP 200
# [Asserts]
# header "Content-Type" contains "text/event-stream"

# ============================================
# Test 4: æ— æ•ˆåœºæ™¯åº”è¿”å› 400
# ============================================
# POST {{BASE_URL}}/api/weaver/v2/generate
# Content-Type: application/json
# Cookie: next-auth.session-token={{SESSION_TOKEN}}
# {
#     "scenario": "invalid_scenario"
# }
# 
# HTTP 400
