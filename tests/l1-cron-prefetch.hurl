# ============================================
# L1: Cron Prefetch ç«¯ç‚¹æµ‹è¯•
# ============================================
# ç«¯ç‚¹: GET /api/cron/prefetch
# åŠŸèƒ½: è§¦å‘æ¯æ—¥å¤ä¹ é˜Ÿåˆ—çš„ç¼“å­˜é¢„ç”Ÿæˆ
# å®‰å…¨: éœ€è¦ CRON_SECRET è®¤è¯ (é˜²æ­¢æ»¥ç”¨)
#
# âš ï¸ æ³¨æ„: å½“ CRON_SECRET æœªé…ç½®æ—¶ï¼Œè®¤è¯è¢«è·³è¿‡
#
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# ğŸ“‹ è§„æ ¼å®šä¹‰ (Specification)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# Input (Headers):
#   Authorization: Bearer <CRON_SECRET>
#
# Output (JSON Schema):
#   {
#     "status": "success",
#     "message": string,
#     "stats": {
#       "successCount": number,
#       "skipCount": number,
#       "errorCount": number
#     }
#   }
#
# Error Response:
#   401: { "error": "Unauthorized" }
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# ============================================
# Test 1: æ­£ç¡®è°ƒç”¨åº”è¿”å›æˆåŠŸ (Happy Path)
# ============================================
# å¼€å‘ç¯å¢ƒä¸‹ CRON_SECRET å¯èƒ½æœªé…ç½®ï¼Œæ‰€ä»¥ç›´æ¥æµ‹è¯•åŠŸèƒ½
GET {{BASE_URL}}/api/cron/prefetch
Authorization: Bearer {{CRON_SECRET}}

HTTP 200
[Captures]
success_count: jsonpath "$.stats.successCount"
skip_count: jsonpath "$.stats.skipCount"
[Asserts]
# 1. Schema éªŒè¯
jsonpath "$.status" isString
jsonpath "$.message" isString
jsonpath "$.stats" exists

# 2. ä¸šåŠ¡é€»è¾‘éªŒè¯
jsonpath "$.status" == "success"
jsonpath "$.stats.successCount" isInteger
jsonpath "$.stats.skipCount" isInteger
jsonpath "$.stats.errorCount" isInteger
