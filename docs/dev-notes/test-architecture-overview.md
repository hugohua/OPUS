# Opus æµ‹è¯•ä½“ç³»å…¨æ™¯å›¾ (Test Architecture Overview)

> æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0
> æœ€åæ›´æ–°ï¼š2026-01-31
> çŠ¶æ€ï¼šActive
> **å½“å‰é˜¶æ®µï¼šL0 é“¾è·¯æ‰“é€š (L1/L2 å°šæœªå®ç°)**

## ğŸ¯ å½“å‰èšç„¦ï¼šL0 åœºæ™¯çŸ©é˜µ

| åœºæ™¯ | æ¨¡å¼ | ç»´åº¦ | äº¤äº’ | æµ‹è¯•çŠ¶æ€ |
|------|------|------|------|----------|
| **S-V-O å¥æ³•** | `SYNTAX` | V (Visual) | Swipe Card | âœ… å·²è¦†ç›– |
| **1+N çŸ­è¯­** | `PHRASE` | C (Context) | Bubble Select | âœ… å·²è¦†ç›– |
| **é—ªç”µæˆ˜** | `BLITZ` | V (Visual) | Bubble Select | âœ… å·²è¦†ç›– |

> L1 (Chunking) / L2 (Context) ä¸šåŠ¡é€»è¾‘å°šæœªå®ç°ï¼Œè¯„ä¼°è„šæœ¬å·²é¢„ç•™æ¥å£ã€‚

---

## ğŸ“Š å…¨æ™¯ç»Ÿè®¡

| ç±»åˆ« | æ•°é‡ | ä½ç½® |
|------|------|------|
| **Vitest Unit Tests** | 24 | `*/__tests__/*.test.ts(x)` |
| **Hurl API Tests** | 5 | `tests/l{1,2}-*.hurl` |
| **æ‰‹åŠ¨æµ‹è¯•è„šæœ¬** | 8 | `scripts/test-*.ts` |
| **LLM è¯„ä¼°è„šæœ¬** | 2 | `scripts/eval*.ts` |
| **è¯„ä¼°æ•°æ®é›†** | 2 | `tests/evals/*.json` |

---

## ğŸ”€ æ··åˆæµ‹è¯•ç­–ç•¥ (Hybrid Testing)

> ğŸ“‹ å®Œæ•´è§„èŒƒè§ `.agent/rules/testing-protocol.md`

### Spec-First åŸåˆ™
```
ç¦æ­¢ç›´æ¥ç¼–å†™å®ç°ä»£ç ã€‚å¿…é¡»å…ˆå®šä¹‰æµ‹è¯•è§„æ ¼ã€‚
```

### æµ‹è¯•å·¥å…·åˆ†å±‚

| ç»„ä»¶ç±»å‹ | æµ‹è¯•å·¥å…· | å¼€å‘é¡ºåº |
|----------|----------|----------|
| **Route Handlers** | Hurl | å…ˆå†™ `.hurl` â†’ å†å†™ `route.ts` |
| **Server Actions** | Vitest | å…ˆå†™ `.test.ts` â†’ å†å†™ Action |
| **LLM Prompts** | Evals | å…ˆå®šä¹‰åŸºçº¿ â†’ å†æ”¹ Prompt |

### æµ‹è¯•å±‚çº§

| å±‚çº§ | åç§° | è¦†ç›–èŒƒå›´ | è§¦å‘æ—¶æœº |
|------|------|----------|----------|
| **L1** | é˜²å¾¡å±‚ | è®¤è¯ã€åŸºç¡€ CRUD | æ¯æ¬¡ PR |
| **L2** | è¿›æ”»å±‚ | ä¸šåŠ¡é€»è¾‘ã€AI é›†æˆ | æ¯æ¬¡ PR |
| **L3** | è§„æ ¼å±‚ | SSE æµã€E2E | å‘å¸ƒå‰ |
| **Eval** | è´¨é‡å±‚ | LLM è¾“å‡ºè¯„åˆ† | Prompt å˜æ›´ |

---

## ğŸ—ºï¸ æµ‹è¯•è¦†ç›–åœ°å›¾

### 1. æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ (Tier 1 - å¿…é¡»è¦†ç›–)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CORE MECHANICS                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… FSRS çŠ¶æ€æœº           â”‚  actions/__tests__/record-outcome.test.ts â”‚
â”‚     - New â†’ Learning â†’ Review                                       â”‚
â”‚     - Grade æ˜ å°„ (1-4)                                              â”‚
â”‚     - Interval è®¡ç®— (Easy > Good)                                   â”‚
â”‚     - Implicit Grading (Duration â†’ Grade)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… OMPS é€‰è¯å¼•æ“          â”‚  lib/services/__tests__/omps-core.test.ts â”‚
â”‚     - 70/30 é…æ¯” (Review/New)                                       â”‚
â”‚     - åˆ†å±‚é‡‡æ · (2ç®€å• + 6æ ¸å¿ƒ + 2å›°éš¾)                                â”‚
â”‚     - excludeIds è¿‡æ»¤                                                â”‚
â”‚     - posFilter è¯æ€§è¿‡æ»¤                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… å¤šè½¨éš”ç¦»               â”‚  actions/__tests__/multi-track.test.ts    â”‚
â”‚     - Track Isolation (VISUAL vs AUDIO)                              â”‚
â”‚     - OMPS Routing (æŒ‰ Track è¿‡æ»¤)                                   â”‚
â”‚     - Default Track Fallback                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… æ— é™æµæœºåˆ¶              â”‚  components/session/__tests__/session-runner.test.tsx â”‚
â”‚     - Pre-fetch (remaining â‰¤ 10)                                     â”‚
â”‚     - Session Loop (é”™é¢˜é‡å…¥é˜Ÿåˆ—)                                    â”‚
â”‚     - Progress Bar åŠ¨æ€è®¡ç®—                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æ•°æ®è·å–å±‚ (Tier 2 - é‡è¦)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA LAYER                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… æ‰¹é‡è·å–               â”‚  actions/__tests__/get-next-drill.test.ts â”‚
â”‚     - 30/50/20 Protocol                                              â”‚
â”‚     - PHRASE Fast Path (DB ä¼˜å…ˆ)                                     â”‚
â”‚     - Plan B è§¦å‘ (ç¼“å­˜å‡»ç©¿)                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… ç¼“å­˜å±‚                 â”‚  lib/__tests__/inventory.test.ts          â”‚
â”‚     - Redis Push/Pop                                                 â”‚
â”‚     - Inventory Counts                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… Drill Cache            â”‚  lib/__tests__/drill-cache.test.ts       â”‚
â”‚     - DB Fallback                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Worker å±‚ (Tier 3 - åå°ä»»åŠ¡)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         WORKER LAYER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… Drill Processor        â”‚  workers/__tests__/drill-processor.test.ts â”‚
â”‚     - Safe JSON Parse (æˆªæ–­æ¢å¤)                                     â”‚
â”‚     - Smart Fetch (Plan A - æ—  ID æ–°è¯è·å–)                          â”‚
â”‚     - Plan C (æŒ‡å®š vocabIds)                                         â”‚
â”‚     - Race Condition Fix (åº“å­˜é¢„æ£€)                                  â”‚
â”‚     - LLM Failure â†’ Job Failure (BullMQ Retry)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… Drill Routing          â”‚  workers/__tests__/drill-routing.test.ts  â”‚
â”‚     - Mode â†’ Generator æ˜ å°„                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. AI å±‚ (Tier 4)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AI LAYER                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… AI Client              â”‚  lib/ai/__tests__/client.test.ts          â”‚
â”‚  âœ… AI Utils               â”‚  lib/ai/__tests__/utils.test.ts           â”‚
â”‚  âœ… Context Selector       â”‚  lib/ai/__tests__/context-selector.test.tsâ”‚
â”‚  âœ… Vocabulary AI          â”‚  lib/ai/__tests__/VocabularyAIService.test.ts â”‚
â”‚  âœ… Article AI             â”‚  lib/ai/__tests__/ArticleAIService.test.tsâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… Validations            â”‚  lib/validations/__tests__/ai.test.ts     â”‚
â”‚                            â”‚  lib/validations/__tests__/article.test.tsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. å…¶ä»–æ¨¡å—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        OTHER MODULES                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… Phrase Mode Algorithm  â”‚  lib/algorithm/__tests__/phrase-mode.test.ts â”‚
â”‚  âœ… Hybrid Selector        â”‚  lib/engine/__tests__/hybrid-selector.test.ts â”‚
â”‚  âœ… Inventory Queue        â”‚  lib/queue/__tests__/inventory-queue.test.ts â”‚
â”‚  âœ… Word Selection Service â”‚  lib/services/__tests__/WordSelectionService.test.ts â”‚
â”‚  âœ… Article Action         â”‚  actions/__tests__/article.test.ts         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª æ‰‹åŠ¨æµ‹è¯•è„šæœ¬ (scripts/test-*.ts)

| è„šæœ¬ | ç”¨é€” | è¿è¡Œæ–¹å¼ |
|------|------|----------|
| `test-engine.ts` | Drill Engine ç«¯åˆ°ç«¯æµ‹è¯• | `npx tsx scripts/test-engine.ts` |
| `test-session-flow.ts` | Session æµç¨‹éªŒè¯ | `npx tsx scripts/test-session-flow.ts` |
| `test-word-selection.ts` | é€‰è¯é€»è¾‘éªŒè¯ | `npx tsx scripts/test-word-selection.ts` |
| `test-generate-briefing.ts` | Briefing ç”Ÿæˆæµ‹è¯• | `npx tsx scripts/test-generate-briefing.ts` |
| `test-blitz-lib.ts` | Blitz æ¨¡å¼åº“æµ‹è¯• | `npx tsx scripts/test-blitz-lib.ts` |
| `test-article-generation.ts` | æ–‡ç« ç”Ÿæˆæµ‹è¯• | `npx tsx scripts/test-article-generation.ts` |
| `test-openai-proxy.ts` | OpenAI ä»£ç†æµ‹è¯• | `npx tsx scripts/test-openai-proxy.ts` |
| `test-pos-fix.ts` | è¯æ€§ä¿®å¤æµ‹è¯• | `npx tsx scripts/test-pos-fix.ts` |

---

## ğŸ“ LLM è¯„ä¼°ä½“ç³» (scripts/eval*.ts)

| è„šæœ¬ | ç”¨é€” | è¿è¡Œç¤ºä¾‹ |
|------|------|----------|
| `eval-prompts.ts` | æ‰¹é‡è¯„æµ‹ + LLM è£åˆ¤ | `npx tsx scripts/eval-prompts.ts --mode L0_SYNTAX --judge ets-auditor` |
| `evaluate-context-quality.ts` | ä¸Šä¸‹æ–‡è´¨é‡è¯„ä¼° | `npx tsx scripts/evaluate-context-quality.ts` |
| `generate-eval-samples.ts` | æ ·æœ¬ç”Ÿæˆ | `npx tsx scripts/generate-eval-samples.ts --level=0 --variant=blitz` |

**è¯„ä¼°æ•°æ®é›†**:
- `tests/evals/l0-syntax.json` - L0 Syntax æµ‹è¯•ç”¨ä¾‹
- `tests/evals/l1-chunking.json` - L1 Chunking æµ‹è¯•ç”¨ä¾‹

---

## âš ï¸ Gap åˆ†æ (ç¼ºå¤±é¡¹)

### ğŸ”´ é«˜ä¼˜å…ˆçº§ (P0)

| ç¼ºå¤±é¡¹ | å½±å“ | å»ºè®® |
|--------|------|------|
| **ä¾èµ–ç†”æ–­æµ‹è¯•** | L0 æœªæŒæ¡æ—¶å¯èƒ½æ¨é€ L1/L2 | æ–°å¢ `circuit-breaker.test.ts` |
| **æ··åˆæµ Interleaving æµ‹è¯•** | å¯èƒ½è¿ç»­ 10 é¢˜åŒç±»å‹ | æ–°å¢ ratio æ ¡éªŒç”¨ä¾‹ |

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (P1)

| ç¼ºå¤±é¡¹ | å½±å“ | å»ºè®® |
|--------|------|------|
| **å‹åŠ›æµ‹è¯• (k6)** | æ— æ³•éªŒè¯ 1000 é¢˜ç¨³å®šæ€§ | åˆ›å»º `tests/load/` ç›®å½• |
| **TTS å¹¶å‘æµ‹è¯•** | Python æœåŠ¡å¯èƒ½å †ç§¯ | æ–°å¢ Python pytest |
| **äº”ç»´é›·è¾¾è¦†ç›–æµ‹è¯•** | åªæœ‰ V/C ç»´åº¦æœ‰æµ‹è¯• | è¡¥å…… A/M/X ç»´åº¦ |

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ (P2)

| ç¼ºå¤±é¡¹ | å½±å“ | å»ºè®® |
|--------|------|------|
| **Admin Inspector** | æ— äººå·¥å®¡è®¡å…¥å£ | æ–°å¢ Dashboard é¡µé¢ |
| **Bad Case å›æµ** | æ— æ³•æŒç»­æ”¹è¿› | éœ€ DB Schema æ”¯æŒ |
| **E2E Browser Test** | æ— å®Œæ•´ç”¨æˆ·æµç¨‹æµ‹è¯• | Playwright é›†æˆ |

---

## ğŸƒ å¿«é€Ÿè¿è¡ŒæŒ‡å—

```bash
# è¿è¡Œå…¨éƒ¨ Unit Tests
npm test

# è¿è¡ŒæŒ‡å®šæ¨¡å—æµ‹è¯•
npx vitest run actions/__tests__/

# è¿è¡Œå•ä¸ªæ–‡ä»¶
npx vitest run lib/services/__tests__/omps-core.test.ts

# Watch æ¨¡å¼
npm run test:watch

# è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# LLM è¯„ä¼° (ä¿®æ”¹ Prompt åå¿…è·‘)
npx tsx scripts/eval-prompts.ts --mode L0_SYNTAX --judge ets-auditor
```

---

## ğŸ“ æµ‹è¯•é‡‘å­—å¡”

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ E2E     â”‚  â† âš ï¸ ç¼ºå¤± (Playwright)
                    â”‚ Browser â”‚
                  â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”
                  â”‚ Integration â”‚  â† âœ… multi-track.test.ts
                  â”‚   Tests     â”‚     (çœŸå® DB + å¤šæ¨¡å—)
              â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
              â”‚    Unit Tests       â”‚  â† âœ… 21 ä¸ªæ–‡ä»¶
              â”‚ (Mock + éš”ç¦»)        â”‚
          â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
          â”‚       LLM Evaluation        â”‚  â† âœ… eval-prompts.ts
          â”‚   (AI è´¨é‡ + è§„åˆ™æ ¡éªŒ)        â”‚
      â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
      â”‚          Static Analysis            â”‚  â† âœ… TypeScript + ESLint
      â”‚       (ç±»å‹æ£€æŸ¥ + Zod Schema)        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æµ‹è¯•æŒ‡å—](./TESTING.md) - Vitest é…ç½®ã€Mocking è§„åˆ™
- [è¯„ä¼°çŸ©é˜µ](./evaluation-matrix.md) - ä¸‰ç»´è¯„ä¼°ä½“ç³» (Logic/Quality/Stability)
- [LLM è¯„ä¼°æ¶æ„](./llm-eval-architecture.md) - AI è£åˆ¤å‘˜è®¾è®¡
